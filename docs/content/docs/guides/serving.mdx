---
title: Serving
description: Serve the OpenAPI spec at runtime with OpenApiModule
---

While nestjs-openapi-static generates specs statically, you can serve the generated specification at runtime using the included `OpenApiModule`.

## Basic Usage

```typescript
import { Module } from '@nestjs/common';
import { OpenApiModule } from 'nestjs-openapi-static';

@Module({
  imports: [
    OpenApiModule.forRoot({
      filePath: 'openapi.json',
    }),
  ],
})
export class AppModule {}
```

This serves the OpenAPI spec at `GET /openapi.json`.

## Configuration Options

```typescript
OpenApiModule.forRoot({
  // Path to the generated OpenAPI JSON file (required)
  filePath: 'openapi.json',

  // Enable/disable the module (default: true)
  enabled: process.env.NODE_ENV !== 'production',

  // Path to serve the JSON spec (default: '/openapi.json')
  jsonPath: '/openapi.json',

  // Enable Swagger UI (default: false)
  serveSwaggerUi: true,

  // Path for Swagger UI (default: '/api-docs')
  swaggerUiPath: '/api-docs',

  // Custom title for Swagger UI (uses spec title by default)
  swaggerUiTitle: 'My API Documentation',
});
```

## Options Reference

| Option           | Type      | Default           | Description                                        |
| ---------------- | --------- | ----------------- | -------------------------------------------------- |
| `filePath`       | `string`  | -                 | Path to the generated OpenAPI JSON file (required) |
| `enabled`        | `boolean` | `true`            | Whether the module is enabled                      |
| `jsonPath`       | `string`  | `'/openapi.json'` | Path to serve the JSON spec                        |
| `serveSwaggerUi` | `boolean` | `false`           | Whether to serve Swagger UI                        |
| `swaggerUiPath`  | `string`  | `'/api-docs'`     | Path for Swagger UI                                |
| `swaggerUiTitle` | `string`  | `spec.info.title` | Custom title for Swagger UI page                   |

## With Swagger UI

Serve interactive documentation with Swagger UI:

```typescript
@Module({
  imports: [
    OpenApiModule.forRoot({
      filePath: 'openapi.json',
      serveSwaggerUi: true,
      swaggerUiPath: '/docs',
    }),
  ],
})
export class AppModule {}
```

This creates two endpoints:

- `GET /openapi.json` - Raw OpenAPI spec
- `GET /docs` - Swagger UI interface

<Callout>
  Swagger UI is loaded from unpkg.com CDN. No additional packages are required.
</Callout>

## Environment-Based Configuration

Disable in production or enable based on environment:

```typescript
@Module({
  imports: [
    OpenApiModule.forRoot({
      filePath: 'openapi.json',
      enabled: process.env.NODE_ENV !== 'production',
      serveSwaggerUi: process.env.SWAGGER_UI === 'true',
    }),
  ],
})
export class AppModule {}
```

When `enabled` is `false`, no routes are registered and the module is essentially a no-op.

## Custom Paths

Configure custom paths for both endpoints:

```typescript
@Module({
  imports: [
    OpenApiModule.forRoot({
      filePath: 'openapi.json',
      jsonPath: '/api/v1/openapi.json',
      serveSwaggerUi: true,
      swaggerUiPath: '/api/v1/docs',
    }),
  ],
})
export class AppModule {}
```

## File Path Resolution

The `filePath` is resolved relative to the current working directory (`process.cwd()`):

```typescript
// Relative path (recommended)
filePath: 'openapi.json';

// Relative path with directory
filePath: 'src/openapi/spec.json';

// Absolute path
filePath: '/var/app/openapi.json';
```

<Callout type="warn">
  The spec file must exist when the NestJS application starts. Run
  `nestjs-openapi-static generate` before starting your app.
</Callout>

## Error Handling

If the spec file is not found, a helpful error is thrown:

```
OpenAPI spec file not found: openapi.json.
Make sure to run 'nestjs-openapi-static generate' first.
```

## Injecting the Spec

You can inject the loaded spec in your services:

```typescript
import { Injectable, Inject } from '@nestjs/common';
import { OPENAPI_SPEC } from 'nestjs-openapi-static';
import type { OpenApiSpec } from 'nestjs-openapi-static';

@Injectable()
export class ApiInfoService {
  constructor(@Inject(OPENAPI_SPEC) private readonly spec: OpenApiSpec) {}

  getApiVersion(): string {
    return this.spec.info.version;
  }

  getOperationCount(): number {
    return Object.values(this.spec.paths).flatMap((methods) =>
      Object.keys(methods),
    ).length;
  }
}
```

Available injection tokens:

- `OPENAPI_SPEC` - The loaded OpenAPI specification object
- `OPENAPI_MODULE_OPTIONS` - The resolved module options

## Complete Example

```typescript
import { Module } from '@nestjs/common';
import { ConfigModule, ConfigService } from '@nestjs/config';
import { OpenApiModule } from 'nestjs-openapi-static';

@Module({
  imports: [
    ConfigModule.forRoot(),
    OpenApiModule.forRoot({
      filePath: 'openapi.json',
      enabled: process.env.NODE_ENV !== 'production',
      jsonPath: '/api/openapi.json',
      serveSwaggerUi: true,
      swaggerUiPath: '/api/docs',
      swaggerUiTitle: 'My API - Interactive Documentation',
    }),
  ],
})
export class AppModule {}
```

## Workflow

The recommended workflow is:

1. **Generate** the spec during build/CI:

   ```bash
   npm run build
   npx nestjs-openapi-static generate -c openapi.config.ts
   ```

2. **Commit** the generated spec (optional but recommended)

3. **Serve** at runtime:
   ```typescript
   OpenApiModule.forRoot({
     filePath: 'openapi.json',
     serveSwaggerUi: true,
   });
   ```

Why generate at build time instead of runtime?

- App starts faster
- Spec works even if source files change
- All instances serve the same spec

## Alternative: Static File Serving

If you prefer not to use `OpenApiModule`, you can serve the spec as a static file:

```typescript
import { Module } from '@nestjs/common';
import { ServeStaticModule } from '@nestjs/serve-static';
import { join } from 'path';

@Module({
  imports: [
    ServeStaticModule.forRoot({
      rootPath: join(__dirname, '..'),
      serveRoot: '/api',
      serveStaticOptions: {
        index: false,
      },
    }),
  ],
})
export class AppModule {}
```

Then access at `/api/openapi.json`.

## Next Steps

- [Swagger UI Recipe](/docs/recipes/swagger-ui) - Advanced Swagger UI configuration
- [CI/CD Recipe](/docs/recipes/ci-cd) - Generate specs in pipelines
- [API Reference: OpenApiModule](/docs/api/openapi-module) - Full API documentation
